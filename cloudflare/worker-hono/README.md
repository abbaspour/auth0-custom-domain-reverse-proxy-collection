# Auth0 Custom Domain Reverse Proxy with Hono

This directory contains a Cloudflare Worker implementation using the [Hono](https://hono.dev/) framework to serve as a reverse proxy for Auth0 custom domains.

## Features

- Built with the Hono framework for efficient request handling
- Bundled with esbuild to include all dependencies in a single file
- No external imports in the final JavaScript file
- Error handling for improved reliability
- TypeScript for type safety

## Prerequisites

- Node.js and npm installed
- Cloudflare account
- Wrangler CLI installed (`npm install -g wrangler`)
- Environment variables set in `.env` file (created by Terraform)

## Setup

1. Install dependencies:
   ```
   npm install
   ```

2. Build the worker:
   ```
   npm run build
   ```
   or
   ```
   make build
   ```

3. Deploy the worker:
   ```
   npm run deploy
   ```
   or
   ```
   make deploy
   ```

## Build Process

The build process uses esbuild to:
- Bundle all dependencies (including Hono) into a single file
- Minify the code for optimal performance
- Output as an ES module
- Remove all external imports

The build configuration is defined in the `package.json` file:

```
"build": "esbuild src/index.ts --bundle --minify --format=esm --outfile=dist/index.js"
```

## Available Commands

- `npm run build` or `make build` - Build the worker
- `npm run deploy` or `make deploy` - Deploy the worker to Cloudflare
- `npm run dev` or `make dev` - Run the worker locally for development
- `npm run lint` or `make lint` - Lint the code
- `npm run format` or `make format` - Format the code

## Configuration Files

- `src/index.ts` - The TypeScript source code
- `dist/index.js` - The bundled output file
- `package.json` - Node.js package configuration
- `wrangler.toml` - Cloudflare Worker configuration
- `.env` - Environment variables (generated by Terraform)

## Environment Variables

The following environment variables are required:
- `CNAME_API_KEY` - API key for Auth0 custom domain
- `AUTH0_EDGE_LOCATION` - Auth0 edge location domain

These variables are automatically set in the `.env` file by Terraform.